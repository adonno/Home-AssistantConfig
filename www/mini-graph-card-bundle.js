function _templateObject25(){const e=_taggedTemplateLiteral(["\n          <div class='info__item'>\n            <span class='info__item__type'>","</span>\n            <span class='info__item__value'>\n              ","\n              ","\n            </span>\n            <span class='info__item__time'>\n              ","\n            </span>\n          </div>"]);return _templateObject25=function(){return e},e}function _templateObject24(){const e=_taggedTemplateLiteral(["\n      <div class='info flex'>\n        ","\n      </div>"]);return _templateObject24=function(){return e},e}function _templateObject23(){const e=_taggedTemplateLiteral(["\n      <div class='graph__labels flex'>\n        <span class='label--max'>","</span>\n        <span class='label--min'>","</span>\n      </div>"]);return _templateObject23=function(){return e},e}function _templateObject22(){const e=_taggedTemplateLiteral(["\n      <svg width='100%' height="," viewBox='0 0 500 ","'\n        @click=",">\n        <g>\n          ","\n          ","\n          ","\n          ","\n        </g>\n        ","\n      </svg>"]);return _templateObject22=function(){return e},e}function _templateObject21(){const e=_taggedTemplateLiteral(["<g class='bars' ?anim=",">","</g>"]);return _templateObject21=function(){return e},e}function _templateObject20(){const e=_taggedTemplateLiteral(["\n        <rect class='bar' x="," y="," height="," width=","\n          .id="," .value="," .entity="," fill=","\n          @mouseover=","\n          @mouseout=",">\n          ","\n        </rect>"]);return _templateObject20=function(){return e},e}function _templateObject19(){const e=_taggedTemplateLiteral(["\n          <animate attributeName='y' from="," to="," dur='1s' fill='remove'\n            calcMode='spline' keyTimes='0; 1' keySplines='0.215 0.61 0.355 1'>\n          </animate>"]);return _templateObject19=function(){return e},e}function _templateObject18(){const e=_taggedTemplateLiteral(["<defs>","</defs>"]);return _templateObject18=function(){return e},e}function _templateObject17(){const e=_taggedTemplateLiteral(["\n            <stop stop-color=","\n              offset=","\n            />\n          "]);return _templateObject17=function(){return e},e}function _templateObject16(){const e=_taggedTemplateLiteral(["\n        <linearGradient id=",">\n          ","\n        </linearGradient>"]);return _templateObject16=function(){return e},e}function _templateObject15(){const e=_taggedTemplateLiteral(["\n          <circle\n            class='line--point' .id="," .value="," .entity=","\n            stroke=","\n            fill=","\n            cx="," cy="," r=","\n            @mouseover=","\n            @mouseout=","\n          />"]);return _templateObject15=function(){return e},e}function _templateObject14(){const e=_taggedTemplateLiteral(["\n      <g class='line--points'\n        ?init=","\n        anim=","\n        style=\"animation-delay: ","\"\n        fill=","\n        stroke=","\n        stroke-width=",">\n        ","\n      </g>"]);return _templateObject14=function(){return e},e}function _templateObject13(){const e=_taggedTemplateLiteral(["\n      <path\n        class='line'\n        .id="," anim="," ?init=","\n        style=\"animation-delay: ","\"\n        fill='none'\n        stroke-dasharray="," stroke-dashoffset=","\n        stroke=","\n        stroke-width=","\n        d=","\n      />"]);return _templateObject13=function(){return e},e}function _templateObject12(){const e=_taggedTemplateLiteral(["\n      <defs>\n        <linearGradient id="," x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n          <stop stop-color="," offset='0%' stop-opacity='1'/>\n          <stop stop-color="," offset='100%' stop-opacity='.15'/>\n        </linearGradient>\n      </defs>\n      <path\n        class='line--fill'\n        type=","\n        .id="," anim="," ?init=","\n        style=\"animation-delay: ","\"\n        fill=","\n        stroke=","\n        stroke-width=","\n        d=","\n      />"]);return _templateObject12=function(){return e},e}function _templateObject11(){const e=_taggedTemplateLiteral(["\n        <div class='graph__legend__item' @click=",">\n          <svg width='10' height='10'>\n            <rect width='10' height='10' fill="," />\n          </svg>\n          <span class='ellipsis'>","</span>\n        </div>\n      "]);return _templateObject11=function(){return e},e}function _templateObject10(){const e=_taggedTemplateLiteral(["\n      <div class='graph__legend'>\n      ","\n      </div>"]);return _templateObject10=function(){return e},e}function _templateObject9(){const e=_taggedTemplateLiteral(["\n      <div class='graph'>\n        <div class='graph__container'>\n          ","\n          <div class='graph__container__svg'>\n            ","\n          </div>\n        </div>\n        ","\n      </div>"]);return _templateObject9=function(){return e},e}function _templateObject8(){const e=_taggedTemplateLiteral(["\n      <div class='state__time'>\n        <span>","</span> - <span>","</span>\n      </div>"]);return _templateObject8=function(){return e},e}function _templateObject7(){const e=_taggedTemplateLiteral(["\n        <div class='state state--small'>\n          <span class='state__value ellipsis'>\n            ","\n          </span>\n          <span class='state__uom ellipsis'>\n            ","\n          </span>\n        </div>"]);return _templateObject7=function(){return e},e}function _templateObject6(){const e=_taggedTemplateLiteral(["\n        <div class='states flex' loc=",">\n          <div class='state'>\n            <span class='state__value ellipsis'>\n              ","\n            </span>\n            <span class='state__uom ellipsis'>\n              ","\n            </span>\n            ","\n          </div>\n          <div class='states--secondary'>","</div>\n          ","\n        </div>"]);return _templateObject6=function(){return e},e}function _templateObject5(){const e=_taggedTemplateLiteral(["\n      <div class='name flex'>\n        <span class='ellipsis'>","</span>\n      </div>"]);return _templateObject5=function(){return e},e}function _templateObject4(){const e=_taggedTemplateLiteral(["\n      <div class='icon' loc=",">\n        <ha-icon .icon=","></ha-icon>\n      </div>"]);return _templateObject4=function(){return e},e}function _templateObject3(){const e=_taggedTemplateLiteral(["\n      <div class='header flex' loc=",">\n        ","\n        ","\n      </div>"]);return _templateObject3=function(){return e},e}function _templateObject2(){const e=_taggedTemplateLiteral(["\n      <ha-card\n        class='flex'\n        ?group=","\n        ?fill=","\n        ?points=","\n        ?labels=","\n        ?gradient=","\n        ?more-info=","\n        style='font-size: ","px;'\n        @click=",">\n        ","\n        ","\n        ","\n        ","\n      </ha-card>"]);return _templateObject2=function(){return e},e}function _templateObject(){const e=_taggedTemplateLiteral(["\n  :host {\n    display: flex;\n    flex-direction: column;\n  }\n  ha-card {\n    flex-direction: column;\n    flex: 1;\n    padding: 16px 0;\n    position: relative;\n    overflow: visible;\n  }\n  ha-card > div {\n    padding: 0px 16px 16px 16px;\n  }\n  ha-card > div:last-child {\n    padding-bottom: 0;\n  }\n  ha-card[points] .line--points,\n  ha-card[labels] .graph__labels {\n    opacity: 0;\n    transition: opacity .25s;\n    animation: none;\n  }\n  ha-card[points]:hover .line--points,\n  ha-card:hover .graph__labels {\n    opacity: 1;\n  }\n  ha-card[fill] {\n    padding-bottom: 0;\n  }\n  ha-card[fill] .graph {\n    padding: 0;\n    order: 10;\n  }\n  ha-card[fill] path {\n    stroke-linecap: initial;\n    stroke-linejoin: initial;\n  }\n  ha-card[fill] .graph__legend {\n    order: -1;\n    padding: 0 16px 8px 16px;\n  }\n  ha-card[fill] .info {\n    padding-bottom: 16px;\n  }\n  ha-card[group] {\n    box-shadow: none;\n    padding: 0;\n  }\n  ha-card[group] > div {\n    padding: 0;\n  }\n  ha-card[group] .graph__legend {\n    padding-left: 0;\n    padding-right: 0;\n  }\n  ha-card[more-info] {\n    cursor: pointer;\n  }\n  .flex {\n    display: flex;\n    display: -webkit-flex;\n    min-width: 0;\n  }\n  .header {\n    justify-content: space-between;\n  }\n  .header[loc=\"center\"] {\n    align-self: center;\n  }\n  .header[loc=\"left\"] {\n    align-self: flex-start;\n  }\n  .header[loc=\"right\"] {\n    align-self: flex-end;\n  }\n  .name {\n    align-items: center;\n    min-width: 0;\n    opacity: .8;\n  }\n  .name > span {\n    font-size: 1.2rem;\n    font-weight: 400;\n    max-height: 1.4rem;\n    opacity: .75;\n  }\n  .icon {\n    color: var(--paper-item-icon-color, #44739e);\n    display: inline-block;\n    flex: 0 0 24px;\n    text-align: center;\n    width: 24px;\n    margin-left: auto;\n  }\n  .icon[loc=\"left\"] {\n    order: -1;\n    margin-right: 8px;\n    margin-left: 0;\n  }\n  .icon[loc=\"state\"] {\n    align-self: center;\n  }\n  .states {\n    align-items: flex-start;\n    font-weight: 300;\n    justify-content: space-between;\n    flex-wrap: nowrap;\n  }\n  .states .icon {\n    align-self: center;\n    margin-left: 0;\n  }\n  .states[loc=\"center\"] {\n    justify-content: space-evenly;\n  }\n  .states[loc=\"right\"] > .state {\n    margin-left: auto;\n    order: 2;\n  }\n  .states[loc=\"right\"] > .icon {\n    margin-left: 0;\n  }\n  .states[loc=\"center\"] .states--secondary,\n  .states[loc=\"right\"] .states--secondary {\n    margin-left: 0;\n  }\n  .states[loc=\"center\"] .state__time {\n    left: 50%;\n    transform: translateX(-50%);\n  }\n  .states--secondary {\n    display: flex;\n    flex-flow: column;\n    flex-wrap: wrap;\n    margin-left: 1rem;\n    min-width: 0;\n  }\n  .states--secondary:empty {\n    display: none;\n  }\n  .state {\n    position: relative;\n    display: flex;\n    flex-wrap: wrap;\n    max-width: 100%;\n    min-width: 0;\n  }\n  .state--small {\n    font-size: 0.6em;\n    margin-bottom: .6rem;\n    flex-wrap: nowrap;\n  }\n  .states--secondary > :only-child {\n    font-size: 1em;\n    margin-bottom: 0;\n  }\n  .state__value {\n    display: inline-block;\n    font-size: 2.4em;\n    line-height: 1em;\n    margin-right: .25rem;\n  }\n  .state__uom {\n    align-self: flex-end;\n    display: inline-block;\n    font-size: 1.4em;\n    font-weight: 400;\n    line-height: 1.2em;\n    margin-top: .1em;\n    opacity: .6;\n    vertical-align: bottom;\n  }\n  .state--small .state__uom {\n    flex: 1;\n  }\n  .state__time {\n    font-size: .95rem;\n    font-weight: 500;\n    bottom: -1.1rem;\n    left: 0;\n    opacity: .75;\n    position: absolute;\n    white-space: nowrap;\n  }\n  .states[loc=\"right\"] .state__time {\n    left: initial;\n    right: 0;\n  }\n  .graph {\n    align-self: flex-end;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    margin-top: auto;\n    width: 100%;\n  }\n  .graph__container {\n    display: flex;\n    flex-direction: row;\n    position: relative;\n  }\n  .graph__container__svg {\n    cursor: default;\n    flex: 1;\n  }\n  svg {\n    overflow: hidden;\n  }\n  path {\n    stroke-linecap: round;\n    stroke-linejoin: round;\n  }\n  animate {\n  }\n  .line--fill[anim=\"false\"] {\n    animation: reveal .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--fill[anim=\"false\"][type=\"fade\"] {\n    animation: reveal-2 .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--points[anim=\"false\"],\n  .line[anim=\"false\"] {\n    animation: pop .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--point {\n    cursor: pointer;\n    fill: var(--paper-card-background-color, white);\n    stroke-width: inherit;\n    transition: fill .15s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .line--point:hover {\n    fill: inherit;\n  }\n  .bars {\n    animation: pop .25s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .bars[anim] {\n    animation: bars .5s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .bar {\n    transition: opacity .25s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .bar:hover {\n    opacity: .5;\n    cursor: pointer;\n  }\n  ha-card[gradient] .line--point:hover {\n    fill: var(--primary-text-color, white);\n  }\n  path,\n  .line--points,\n  .line--fill {\n    opacity: 0;\n  }\n  .line--points[anim=\"true\"][init] {\n    animation: pop .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--fill[anim=\"true\"][init] {\n    animation: reveal .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--fill[anim=\"true\"][init][type=\"fade\"] {\n    animation: reveal-2 .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line[anim=\"true\"][init] {\n    animation: dash 1s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .graph__labels {\n    align-items: flex-start;\n    flex-direction: column;\n    font-size: calc(.15em + 8.5px);\n    font-weight: 400;\n    justify-content: space-between;\n    margin-right: 10px;\n    padding: .6em;\n    position: absolute;\n    pointer-events: none;\n    top: 0; bottom: 0;\n    opacity: .75;\n  }\n  .graph__labels > span {\n    cursor: pointer;\n    background: var(--primary-background-color, white);\n    border-radius: 1em;\n    padding: .2em .6em;\n    box-shadow: 0 1px 3px rgba(0,0,0,.12), 0 1px 2px rgba(0,0,0,.24);\n  }\n  .graph__legend {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-evenly;\n    padding-top: 16px;\n    flex-wrap: wrap;\n  }\n  .graph__legend__item {\n    cursor: pointer;\n    display: flex;\n    min-width: 0;\n    margin: .4em;\n    align-items: center\n  }\n  .graph__legend__item span {\n    opacity: .75;\n    margin-left: .4em;\n  }\n  .info {\n    justify-content: space-between;\n    align-items: middle;\n  }\n  .info__item {\n    display: flex;\n    flex-flow: column;\n    align-items: flex-end;\n    text-align: right;\n  }\n  .info__item:first-child {\n    align-items: flex-start;\n    text-align: left;\n  }\n  .info__item__type {\n    text-transform: capitalize;\n    font-weight: 500;\n    opacity: .9;\n  }\n  .info__item__time,\n  .info__item__value {\n    opacity: .75;\n  }\n  .ellipsis {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n  @keyframes reveal {\n    0% { opacity: 0; }\n    100% { opacity: .15; }\n  }\n  @keyframes reveal-2 {\n    0% { opacity: 0; }\n    100% { opacity: .4; }\n  }\n  @keyframes pop {\n    0% { opacity: 0; }\n    100% { opacity: 1; }\n  }\n  @keyframes bars {\n    0% { opacity: 0; }\n    50% { opacity: 0; }\n    100% { opacity: 1; }\n  }\n  @keyframes dash {\n    0% {\n      opacity: 0;\n    }\n    25% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 1;\n      stroke-dashoffset: 0;\n    }\n  }"]);return _templateObject=function(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null==arguments[t]?{}:arguments[t],a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){_defineProperty(e,t,n[t])})}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()})(this,function(){'use strict';var o=Number.isNaN,r=Math.max,s=Math.min,l=Math.ceil,d=Math.abs,p=Math.floor;function e(e){let t=B.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},B.set(e.type,t));let n=t.stringsArray.get(e.strings);if(void 0!==n)return n;const i=e.strings.join(y);return n=t.keyString.get(i),void 0===n&&(n=new w(e,e.getTemplateElement()),t.keyString.set(i,n)),t.stringsArray.set(e.strings,n),n}function t(e,t){const n=e.element.content,i=e.parts,a=document.createTreeWalker(n,W,null,!1);let o=$(i),r=i[o],s=-1,l=0;const d=[];for(let n=null;a.nextNode();){s++;const e=a.currentNode;for(e.previousSibling===n&&(n=null),t.has(e)&&(d.push(e),null===n&&(n=e)),null!==n&&l++;r!==void 0&&r.index===s;)r.index=null===n?r.index-l:-1,o=$(i,o),r=i[o]}d.forEach(e=>e.parentNode.removeChild(e))}function n(e,t){let n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;const i=e.element.content,a=e.parts;if(null===n||void 0===n)return void i.appendChild(t);const o=document.createTreeWalker(i,W,null,!1);let r=$(a),s=0,l=-1;for(;o.nextNode();){l++;const e=o.currentNode;for(e===n&&(s=D(t),n.parentNode.insertBefore(t,n));-1!==r&&a[r].index===l;){if(0<s){for(;-1!==r;)a[r].index+=s,r=$(a,r);return}r=$(a,r)}}}function a(e){let t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[];for(let n=0,i=e.length;n<i;n++){const i=e[n];Array.isArray(i)?a(i,t):t.push(i)}return t}const c=new WeakMap,h=e=>"function"==typeof e&&c.has(e),u=window.customElements!==void 0&&window.customElements.polyfillWrapFlushCallback!==void 0,g=function(e,t){let n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null,a=t;for(;a!==n;){const t=a.nextSibling;e.insertBefore(a,i),a=t}},m=function(e,t){let n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,i=t;for(;i!==n;){const t=i.nextSibling;e.removeChild(i),i=t}},f={},_={},y="{{lit-".concat((Math.random()+"").slice(2),"}}"),v="<!--".concat(y,"-->"),b=new RegExp("".concat(y,"|").concat(v)),x="$lit$";class w{constructor(e,t){this.parts=[],this.element=t;let n=-1,i=0;const a=[],o=t=>{const r=t.content,s=document.createTreeWalker(r,133,null,!1);for(let r=0;s.nextNode();){n++;const t=s.currentNode;if(1===t.nodeType){if(t.hasAttributes()){const a=t.attributes;let o=0;for(let e=0;e<a.length;e++)0<=a[e].value.indexOf(y)&&o++;for(;0<o--;){const a=e.strings[i],o=N.exec(a)[2],r=o.toLowerCase()+x,s=t.getAttribute(r),l=s.split(b);this.parts.push({type:"attribute",index:n,name:o,strings:l}),t.removeAttribute(r),i+=l.length-1}}"TEMPLATE"===t.tagName&&o(t)}else if(3===t.nodeType){const e=t.data;if(0<=e.indexOf(y)){const o=t.parentNode,r=e.split(b),s=r.length-1;for(let e=0;e<s;e++)o.insertBefore(""===r[e]?P():document.createTextNode(r[e]),t),this.parts.push({type:"node",index:++n});""===r[s]?(o.insertBefore(P(),t),a.push(t)):t.data=r[s],i+=s}}else if(8===t.nodeType)if(t.data===y){const e=t.parentNode;(null===t.previousSibling||n===r)&&(n++,e.insertBefore(P(),t)),r=n,this.parts.push({type:"node",index:n}),null===t.nextSibling?t.data="":(a.push(t),n--),i++}else for(let e=-1;-1!==(e=t.data.indexOf(y,e+1));)this.parts.push({type:"node",index:-1})}};o(t);for(const i of a)i.parentNode.removeChild(i)}}const S=e=>-1!==e.index,P=()=>document.createComment(""),N=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F \x09\x0a\x0c\x0d"'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class C{constructor(e,t,n){this._parts=[],this.template=e,this.processor=t,this.options=n}update(e){let t=0;for(const n of this._parts)void 0!==n&&n.setValue(e[t]),t++;for(const t of this._parts)void 0!==t&&t.commit()}_clone(){const e=u?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=this.template.parts;let n=0,i=0;const a=e=>{const o=document.createTreeWalker(e,133,null,!1);for(let r=o.nextNode();n<t.length&&null!==r;){const e=t[n];if(!S(e))this._parts.push(void 0),n++;else if(i===e.index){if("node"===e.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(r.previousSibling),this._parts.push(e)}else this._parts.push(...this.processor.handleAttributeExpressions(r,e.name,e.strings,this.options));n++}else i++,"TEMPLATE"===r.nodeName&&a(r.content),r=o.nextNode()}};return a(e),u&&(document.adoptNode(e),customElements.upgrade(e)),e}}class k{constructor(e,t,n,i){this.strings=e,this.values=t,this.type=n,this.processor=i}getHTML(){const e=this.strings.length-1;let t="";for(let n=0;n<e;n++){const e=this.strings[n],i=N.exec(e);t+=i?e.substr(0,i.index)+i[1]+i[2]+x+i[3]+y:e+v}return t+this.strings[e]}getTemplateElement(){const e=document.createElement("template");return e.innerHTML=this.getHTML(),e}}class T extends k{getHTML(){return"<svg>".concat(super.getHTML(),"</svg>")}getTemplateElement(){const e=super.getTemplateElement(),t=e.content,n=t.firstChild;return t.removeChild(n),g(t,n.firstChild),e}}const E=e=>null===e||"object"!=typeof e&&"function"!=typeof e;class A{constructor(e,t,n){this.dirty=!0,this.element=e,this.name=t,this.strings=n,this.parts=[];for(let a=0;a<n.length-1;a++)this.parts[a]=this._createPart()}_createPart(){return new z(this)}_getValue(){const e=this.strings,t=e.length-1;let n="";for(let a=0;a<t;a++){n+=e[a];const t=this.parts[a];if(void 0!==t){const e=t.value;if(null!=e&&(Array.isArray(e)||"string"!=typeof e&&e[Symbol.iterator]))for(const i of e)n+="string"==typeof i?i:i+"";else n+="string"==typeof e?e:e+""}}return n+=e[t],n}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class z{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===f||E(e)&&e===this.value||(this.value=e,!h(e)&&(this.committer.dirty=!0))}commit(){for(;h(this.value);){const e=this.value;this.value=f,e(this)}this.value===f||this.committer.commit()}}class I{constructor(e){this.value=void 0,this._pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(P()),this.endNode=e.appendChild(P())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e._insert(this.startNode=P()),e._insert(this.endNode=P())}insertAfterPart(e){e._insert(this.startNode=P()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this._pendingValue=e}commit(){for(;h(this._pendingValue);){const e=this._pendingValue;this._pendingValue=f,e(this)}const e=this._pendingValue;e===f||(E(e)?e!==this.value&&this._commitText(e):e instanceof k?this._commitTemplateResult(e):e instanceof Node?this._commitNode(e):Array.isArray(e)||e[Symbol.iterator]?this._commitIterable(e):e===_?(this.value=_,this.clear()):this._commitText(e))}_insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}_commitNode(e){this.value===e||(this.clear(),this._insert(e),this.value=e)}_commitText(e){const t=this.startNode.nextSibling;e=null==e?"":e,t===this.endNode.previousSibling&&3===t.nodeType?t.data=e:this._commitNode(document.createTextNode("string"==typeof e?e:e+"")),this.value=e}_commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof C&&this.value.template===t)this.value.update(e.values);else{const n=new C(t,e.processor,this.options),i=n._clone();n.update(e.values),this._commitNode(i),this.value=n}}_commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let n,i=0;for(const a of e)n=t[i],void 0===n&&(n=new I(this.options),t.push(n),0==i?n.appendIntoPart(this):n.insertAfterPart(t[i-1])),n.setValue(a),n.commit(),i++;i<t.length&&(t.length=i,this.clear(n&&n.endNode))}clear(){let e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.startNode;m(this.startNode.parentNode,e.nextSibling,this.endNode)}}class R{constructor(e,t,n){if(this.value=void 0,this._pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=n}setValue(e){this._pendingValue=e}commit(){for(;h(this._pendingValue);){const e=this._pendingValue;this._pendingValue=f,e(this)}if(this._pendingValue!==f){const e=!!this._pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name)),this.value=e,this._pendingValue=f}}}class G extends A{constructor(e,t,n){super(e,t,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new O(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class O extends z{}let L=!1;try{const e={get capture(){return L=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}class U{constructor(e,t,n){this.value=void 0,this._pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=n,this._boundHandleEvent=t=>this.handleEvent(t)}setValue(e){this._pendingValue=e}commit(){for(;h(this._pendingValue);){const e=this._pendingValue;this._pendingValue=f,e(this)}if(this._pendingValue===f)return;const e=this._pendingValue,t=this.value,n=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive);n&&this.element.removeEventListener(this.eventName,this._boundHandleEvent,this._options),null!=e&&(null==t||n)&&(this._options=M(e),this.element.addEventListener(this.eventName,this._boundHandleEvent,this._options)),this.value=e,this._pendingValue=f}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const M=e=>e&&(L?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);const j=new class{handleAttributeExpressions(e,t,n,i){const a=t[0];if("."===a){const i=new G(e,t.slice(1),n);return i.parts}if("@"===a)return[new U(e,t.slice(1),i.eventContext)];if("?"===a)return[new R(e,t.slice(1),n)];const o=new A(e,t,n);return o.parts}handleTextExpression(e){return new I(e)}},B=new Map,F=new WeakMap,H=(t,n,i)=>{let a=F.get(n);a===void 0&&(m(n,n.firstChild),F.set(n,a=new I(Object.assign({templateFactory:e},i))),a.appendInto(n)),a.setValue(t),a.commit()};(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.0.0");const q=function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new k(e,n,"html",j)},Q=function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new T(e,n,"svg",j)},W=133,D=e=>{let t=11===e.nodeType?0:1;for(const n=document.createTreeWalker(e,W,null,!1);n.nextNode();)t++;return t},$=function(e){let t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:-1;for(let n=t+1;n<e.length;n++){const t=e[n];if(S(t))return n}return-1},J=(e,t)=>"".concat(e,"--").concat(t);let Z=!0;"undefined"==typeof window.ShadyCSS?Z=!1:"undefined"==typeof window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected.Please update to at least @webcomponents/webcomponentsjs@2.0.2 and@webcomponents/shadycss@1.3.1."),Z=!1);const K=e=>t=>{const n=J(t.type,e);let i=B.get(n);void 0===i&&(i={stringsArray:new WeakMap,keyString:new Map},B.set(n,i));let a=i.stringsArray.get(t.strings);if(void 0!==a)return a;const o=t.strings.join(y);if(a=i.keyString.get(o),void 0===a){const n=t.getTemplateElement();Z&&window.ShadyCSS.prepareTemplateDom(n,e),a=new w(t,n),i.keyString.set(o,a)}return i.stringsArray.set(t.strings,a),a},ee=["html","svg"],te=e=>{ee.forEach(n=>{const i=B.get(J(n,e));i!==void 0&&i.keyString.forEach(e=>{const n=e.element.content,i=new Set;Array.from(n.querySelectorAll("style")).forEach(e=>{i.add(e)}),t(e,i)})})},ne=new Set,ie=(e,i,a)=>{ne.add(a);const o=e.querySelectorAll("style");if(0===o.length)return void window.ShadyCSS.prepareTemplateStyles(i.element,a);const r=document.createElement("style");for(let t=0;t<o.length;t++){const e=o[t];e.parentNode.removeChild(e),r.textContent+=e.textContent}if(te(a),n(i,r,i.element.content.firstChild),window.ShadyCSS.prepareTemplateStyles(i.element,a),window.ShadyCSS.nativeShadow){const t=i.element.content.querySelector("style");e.insertBefore(t.cloneNode(!0),e.firstChild)}else{i.element.content.insertBefore(r,i.element.content.firstChild);const e=new Set;e.add(r),t(i,e)}},ae=(e,t,n)=>{const i=n.scopeName,a=F.has(t),o=t instanceof ShadowRoot&&Z&&e instanceof k,r=o&&!ne.has(i),s=r?document.createDocumentFragment():t;if(H(e,s,Object.assign({templateFactory:K(i)},n)),r){const e=F.get(s);F.delete(s),e.value instanceof C&&ie(s,e.value.template,i),m(t,t.firstChild),t.appendChild(s),F.set(t,e)}!a&&o&&window.ShadyCSS.styleElement(t.host)};window.JSCompiler_renameProperty=e=>e;const oe={toAttribute(e,t){return t===Boolean?e?"":null:t===Object||t===Array?null==e?e:JSON.stringify(e):e},fromAttribute(e,t){return t===Boolean?null!==e:t===Number?null===e?null:+e:t===Object||t===Array?JSON.parse(e):e}},re=(e,t)=>t!==e&&(t===t||e===e),se={attribute:!0,type:String,converter:oe,reflect:!1,hasChanged:re},le=Promise.resolve(!0),de=1,pe=4,ce=8,he=16,ue=32;class ge extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=le,this._hasConnectedResolver=void 0,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,n)=>{const i=this._attributeNameForProperty(n,t);void 0!==i&&(this._attributeToPropertyMap.set(i,n),e.push(i))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;e!==void 0&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:se;if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const n="symbol"==typeof e?Symbol():"__".concat(e);Object.defineProperty(this.prototype,e,{get(){return this[n]},set(t){const i=this[e];this[n]=t,this.requestUpdate(e,i)},configurable:!0,enumerable:!0})}static finalize(){if(!(this.hasOwnProperty(JSCompiler_renameProperty("finalized",this))&&this.finalized)){const e=Object.getPrototypeOf(this);if("function"==typeof e.finalize&&e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...("function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[])];for(const n of t)this.createProperty(n,e[n])}}}static _attributeNameForProperty(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t){let n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:re;return n(e,t)}static _propertyValueFromAttribute(e,t){const n=t.type,i=t.converter||oe,a="function"==typeof i?i:i.fromAttribute;return a?a(e,n):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const n=t.type,i=t.converter,a=i&&i.toAttribute||oe.toAttribute;return a(e,n)}initialize(){this._saveInstanceProperties()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this._updateState|=ue,this._hasConnectedResolver?(this._hasConnectedResolver(),this._hasConnectedResolver=void 0):this.requestUpdate()}disconnectedCallback(){}attributeChangedCallback(e,t,n){t!==n&&this._attributeToProperty(e,n)}_propertyToAttribute(e,t){let n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:se;const i=this.constructor,a=i._attributeNameForProperty(e,n);if(a!==void 0){const e=i._propertyValueToAttribute(t,n);if(e===void 0)return;this._updateState|=ce,null==e?this.removeAttribute(a):this.setAttribute(a,e),this._updateState&=~ce}}_attributeToProperty(e,t){if(this._updateState&ce)return;const n=this.constructor,i=n._attributeToPropertyMap.get(e);if(i!==void 0){const e=n._classProperties.get(i)||se;this._updateState|=he,this[i]=n._propertyValueFromAttribute(t,e),this._updateState&=~he}}requestUpdate(e,t){let n=!0;if(void 0!==e&&!this._changedProperties.has(e)){const i=this.constructor,a=i._classProperties.get(e)||se;i._valueHasChanged(this[e],t,a.hasChanged)?(this._changedProperties.set(e,t),!0===a.reflect&&!(this._updateState&he)&&(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,a))):n=!1}return!this._hasRequestedUpdate&&n&&this._enqueueUpdate(),this.updateComplete}async _enqueueUpdate(){this._updateState|=pe;let e;const t=this._updatePromise;this._updatePromise=new Promise(t=>e=t),await t,this._hasConnected||(await new Promise(e=>this._hasConnectedResolver=e));const n=this.performUpdate();null!=n&&"function"==typeof n.then&&(await n),e(!this._hasRequestedUpdate)}get _hasConnected(){return this._updateState&ue}get _hasRequestedUpdate(){return this._updateState&pe}get hasUpdated(){return this._updateState&de}performUpdate(){if(this._instanceProperties&&this._applyInstanceProperties(),this.shouldUpdate(this._changedProperties)){const e=this._changedProperties;this.update(e),this._markUpdated(),this._updateState&de||(this._updateState|=de,this.firstUpdated(e)),this.updated(e)}else this._markUpdated()}_markUpdated(){this._changedProperties=new Map,this._updateState&=~pe}get updateComplete(){return this._updatePromise}shouldUpdate(){return!0}update(){this._reflectingProperties!==void 0&&0<this._reflectingProperties.size&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0)}updated(){}firstUpdated(){}}ge.finalized=!0;const me="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,fe=Symbol();class _e{constructor(e,t){if(t!==fe)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(me?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const ye=e=>{if(e instanceof _e)return e.cssText;throw new Error("Value passed to 'css' function must be a 'css' function result: ".concat(e,". Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security."))};(window.litElementVersions||(window.litElementVersions=[])).push("2.0.1");const ve=e=>e.flat?e.flat(1/0):a(e);class be extends ge{static finalize(){super.finalize(),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}static _getUniqueStyles(){const e=this.styles,t=[];if(Array.isArray(e)){const n=ve(e),i=n.reduceRight((e,t)=>(e.add(t),e),new Set);i.forEach(e=>t.unshift(e))}else e&&t.push(e);return t}initialize(){super.initialize(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0===e.length||(window.ShadyCSS===void 0||window.ShadyCSS.nativeShadow?me?this.renderRoot.adoptedStyleSheets=e.map(e=>e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&window.ShadyCSS!==void 0&&window.ShadyCSS.styleElement(this)}update(e){super.update(e);const t=this.render();t instanceof k&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){}}be.finalized=!0,be.render=ae;const xe=0,X=1,Y=2;class i{constructor(e,t,n){let i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:24,a=4<arguments.length&&arguments[4]!==void 0?arguments[4]:1;this.coords=[],this.width=e-2*n[xe],this.height=t-2*n[X],this.margin=n,this._max=0,this._min=0,this.points=a,this.hours=i}get max(){return this._max}set max(e){this._max=e}get min(){return this._min}set min(e){this._min=e}update(e){const t=new Date().getTime(),n=(e,n)=>{const i=t-new Date(n.last_changed).getTime(),a=i/3600000*this.points-this.hours*this.points,o=d(p(a));return e[o]||(e[o]=[]),e[o].push(n),e},i=e.reduce((e,t)=>n(e,t),[]);i.length=l(this.hours*this.points+1),this.coords=this._calcPoints(i),this.min=s(...this.coords.map(e=>+e[Y])),this.max=r(...this.coords.map(e=>+e[Y]))}_calcPoints(e){var t=Number.isFinite;const n=[];let a=this.width/(this.hours*this.points);a=t(a)?a:this.width;let o=[0,this._average(e.filter(Boolean)[0])];const r=(e,t)=>{const i=a*t+this.margin[xe];return e&&(o=[0,this._average(e)]),n.push([i,...o])};for(let t=0;t<e.length;t+=1)r(e[t],t);return 1===n.length&&(n[1]=[this.width+this.margin[xe],0,n[0][Y]]),n}_calcY(e){const t=(this.max-this.min)/this.height||1;return e.map(e=>[e[xe],this.height-(e[Y]-this.min)/t+1.5*this.margin[X],e[Y]])}getPoints(){const e=this._calcY(this.coords);let t,n,a=e[0];e.shift();const o=e.map((e,o)=>{t=e,n=this._midPoint(a[xe],a[X],t[xe],t[X]);const i=(t[Y]+a[Y])/2;return a=t,[n[xe],n[X],i,o]});return o}getPath(){const e=this._calcY(this.coords);let t,n,i="",a=e[0];return i+="M".concat(a[xe],",").concat(a[X]),e.forEach(e=>{t=e,n=this._midPoint(a[xe],a[X],t[xe],t[X]),i+=" ".concat(n[xe],",").concat(n[X]),i+=" Q ".concat(t[xe],",").concat(t[X]),a=t}),i+=" ".concat(t[xe],",").concat(t[X]),i}computeGradient(e,t){const n=100/this.coords.length,i=this._calcY(this.coords);let a,o=i[0];return i.shift(),i.map((r,s)=>{a=r;const i=(a[Y]+o[Y])/2;return o=a,_objectSpread({offset:n*s+n,color:t},e.find(e=>e.value<i))})}getFill(e){const t=this.height+2*this.margin[X];let n=e;return n+=" L ".concat(this.width-2*this.margin[xe],", ").concat(t),n+=" L ".concat(this.coords[0][xe],", ").concat(t," z"),n}getBars(e,t){const n=this._calcY(this.coords),a=4,o=(this.width-a)/l(this.hours*this.points+1)/t;return n.map((n,r)=>({x:o*r*t+o*e+a,y:n[X],height:this.height-n[X]+3*this.margin[X],width:o-a,value:n[Y]}))}_midPoint(e,t,n,i){return[(e-n)/2+n,(t-i)/2+i]}_average(e){return e.reduce((e,t)=>e+parseFloat(t.state),0)/e.length}}const V=function o(e){for(var t=arguments.length,n=Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const a=n.reduce((t,n,i)=>t+ye(n)+e[i+1],e[0]);return new _e(a,fe)}(_templateObject()),we="https://github.com/kalkih/mini-graph-card/blob/master/README.md",Se=14,Pe=96,Ne={humidity:"hass:water-percent",illuminance:"hass:brightness-5",temperature:"hass:thermometer",battery:"hass:battery"},Ce=["var(--accent-color)","#3498db","#e74c3c","#9b59b6","#f1c40f","#2ecc71"],ke=["entity","line","length","fill","points","tooltip","abs"],Te={name:!0,icon:!0,state:!0,graph:"line",labels:"hover",extrema:!1,legend:!0,fill:!0,points:"hover"},Ee=(e,t)=>e.reduce((e,n)=>+n[t]<+e[t]?n:e,e[0]),Ve=(e,t)=>e.reduce((e,n)=>+n[t]>+e[t]?n:e,e[0]),Ae=(e,t)=>e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!t});class ze extends be{constructor(){super(),this.id=Math.random().toString(36).substr(2,9),this.bound=[0,0],this.abs=[],this.length=[],this.entity=[],this.line=[],this.bar=[],this.fill=[],this.points=[],this.gradient=[],this.tooltip={},this.updateQueue=[]}static get styles(){return V}set hass(e){this._hass=e;let t=!1;this.config.entities.forEach((n,i)=>{const a=e.states[n.entity];a&&this.entity[i]!==a&&(this.entity[i]=a,this.updateQueue.push(a.entity_id),t=!0)}),t&&(this.entity=[...this.entity],this.updateData())}static get properties(){return{id:String,_hass:{},config:{},entity:[],Graph:[],line:[],shadow:[],length:Number,bound:[],abs:[],tooltip:{},updateQueue:[]}}setConfig(e){var t=Math.log;if(e.entity)throw new Error("The \"entity\" option was removed, please use \"entities\".\n See ".concat(we));if(!Array.isArray(e.entities))throw new Error("Please provide the \"entities\" option as a list.\n See ".concat(we));if(e.line_color_above||e.line_color_below)throw new Error("\"line_color_above/line_color_below\" was removed, please use \"color_thresholds\".\n See ".concat(we));const n=_objectSpread({animate:!1,hour24:!1,font_size:Se,height:100,hours_to_show:24,points_per_hour:.5,line_color:[...Ce],color_thresholds:[],line_width:5,more_info:!0},e,{show:_objectSpread({},Te,e.show)});if(n.entities.forEach((e,t)=>{"string"==typeof e&&(n.entities[t]={entity:e})}),"string"==typeof e.line_color&&(n.line_color=[e.line_color,...Ce]),n.font_size=e.font_size/100*Se||Se,n.hours_to_show=p(+n.hours_to_show)||24,n.color_thresholds.sort((e,t)=>t.value-e.value),"bar"===n.show.graph){const e=n.entities.length;let i=n.hours_to_show;i*e>Pe&&(i=p(Pe/e),console.warn("mini-graph-card: Not enough space, reducing hours_to_show to ",i),n.hours_to_show=i),i*n.points_per_hour*e>Pe&&(n.points_per_hour=t(i*e)/t(Pe*e),console.warn("mini-graph-card: Not enough space, adjusting points_per_hour to ",n.points_per_hour))}this.Graph||(this.Graph=n.entities.map(()=>new i(500,n.height,[n.show.fill?0:n.line_width,n.line_width],n.hours_to_show,n.points_per_hour))),this.config=n}shouldUpdate(e){return ke.some(t=>e.has(t))}updated(e){this.config.animate&&e.has("line")&&(this.length.length<this.entity.length?(this.shadowRoot.querySelectorAll("svg path.line").forEach(e=>{this.length[e.id]=e.getTotalLength()}),this.length=[...this.length]):this.length=Array(this.entity.length).fill("none"))}render(){let e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this,t=e.config;return q(_templateObject2(),t.group,t.show.graph&&t.show.fill,"hover"===t.show.points,"hover"===t.show.labels,0<t.color_thresholds.length,t.more_info,t.font_size,t=>this.handlePopup(t,this.entity[0]),this.renderHeader(),this.renderStates(),this.renderGraph(),this.renderInfo())}renderHeader(){const e=this.config,t=e.show,n=e.align_icon,i=e.align_header;return t.name||t.icon&&"state"!==n?q(_templateObject3(),i,this.renderName(),"state"===n?"":this.renderIcon()):""}renderIcon(){return this.config.show.icon?q(_templateObject4(),this.config.align_icon,this.computeIcon(this.entity[0])):""}renderName(){if(this.config.show.name){const e=void 0===this.tooltip.entity?this.config.name||this.computeName(0):this.computeName(this.tooltip.entity);return q(_templateObject5(),e)}}renderStates(){const e=this.tooltip.value===void 0?this.entity[0].state:this.tooltip.value;if(this.config.show.state)return q(_templateObject6(),this.config.align_state,this.computeState(e),this.computeUom(this.tooltip.entity||0),this.renderStateTime(),this.config.entities.map((e,t)=>this.renderState(e,t)),"state"===this.config.align_icon?this.renderIcon():"")}renderState(e,t){if(e.show_state&&0!==t)return q(_templateObject7(),this.computeState(this.entity[t].state),this.computeUom(t))}renderStateTime(){return void 0===this.tooltip.value?void 0:q(_templateObject8(),this.tooltip.time[0],this.tooltip.time[1])}renderGraph(){return this.config.show.graph?q(_templateObject9(),this.renderLabels(),this.renderSvg(),this.renderLegend()):""}renderLegend(){return 1>=this.config.entities.length||!this.config.show.legend?void 0:q(_templateObject10(),this.entity.map((t,n)=>q(_templateObject11(),n=>this.handlePopup(n,t),this.computeColor(t.state,n),this.computeName(n))))}renderSvgFill(e,t){if(!e)return;const n=this.computeColor(this.entity[t].state,t),i="fade"===this.config.show.fill;return Q(_templateObject12(),"fill-grad-".concat(this.id,"-").concat(t),n,n,this.config.show.fill,t,this.config.animate,this.length[t],this.config.animate?"".concat(.5*t,"s"):"0s",i?"url(#fill-grad-".concat(this.id,"-").concat(t,")"):n,i?"url(#fill-grad-".concat(this.id,"-").concat(t,")"):n,this.config.line_width,this.fill[t])}renderSvgLine(e,t){return e?Q(_templateObject13(),t,this.config.animate,this.length[t],this.config.animate?"".concat(.5*t,"s"):"0s",this.length[t]||"none",this.length[t]||"none",this.gradient[t]?"url(#grad-".concat(this.id,"-").concat(t,")"):this.computeColor(this.entity[t].state,t),this.config.line_width,this.line[t]):void 0}renderSvgPoints(e,t){if(e){const n=this.computeColor(this.entity[t].state,t);return Q(_templateObject14(),this.length[t],this.config.animate&&"hover"!==this.config.show.points,this.config.animate?"".concat(.5*t+.5,"s"):"0s",n,n,this.config.line_width/2,e.map((e,n)=>Q(_templateObject15(),e[3],e[2],t,this.gradient[t]?this.gradient[t][n].color:"inherit",this.gradient[t]?this.gradient[t][n].color:"inherit",e[0],e[1],this.config.line_width,t=>this.openTooltip(t),()=>this.tooltip={})))}}renderSvgGradient(e){if(e){const t=e.map((e,t)=>e?Q(_templateObject16(),"grad-".concat(this.id,"-").concat(t),e.map(e=>Q(_templateObject17(),e.color,"".concat(e.offset,"%")))):void 0);return Q(_templateObject18(),t)}}renderSvgBars(e,t){if(e){const n=e.map((e,n)=>{const i=this.config.animate?Q(_templateObject19(),this.config.height,e.y):"",a=this.computeColor(e.value,t);return Q(_templateObject20(),e.x,e.y,e.height,e.width,n,e.value,t,a,t=>this.openTooltip(t),()=>this.tooltip={},i)});return Q(_templateObject21(),this.config.animate,n)}}renderSvg(){const e=this.config.height;return Q(_templateObject22(),0===e?0:"100%",e,t=>t.stopPropagation(),this.renderSvgGradient(this.gradient),this.fill.map((e,t)=>this.renderSvgFill(e,t)),this.line.map((e,t)=>this.renderSvgLine(e,t)),this.bar.map((e,t)=>this.renderSvgBars(e,t)),this.points.map((e,t)=>this.renderSvgPoints(e,t)))}openTooltip(t){const e=this.config,n=e.points_per_hour,i=e.hours_to_show,a=.5*(60/n),o=d(+t.target.id+1-i*n),r=new Date;r.setMinutes(r.getMinutes()-2*a*o-a);const s=Ae(r,this.config.hour24);r.setMinutes(r.getMinutes()+2*a);const l=Ae(r,this.config.hour24);this.tooltip={value:+t.target.value,id:o,entity:t.target.entity,time:[s,l]}}renderLabels(){return this.config.show.labels?q(_templateObject23(),this.computeState(this.bound[1]),this.computeState(this.bound[0])):void 0}renderInfo(){return this.config.show.extrema?q(_templateObject24(),this.abs.map(e=>q(_templateObject25(),e.type,this.computeState(e.state),this.computeUom(0),Ae(new Date(e.last_changed),this.config.hour24)))):void 0}handlePopup(t,e){t.stopPropagation(),this.config.more_info&&this.fire("hass-more-info",{entityId:e.entity_id})}fire(t,n,i){const a=i||{},o=null===n||void 0===n?{}:n,r=new Event(t,{bubbles:void 0===a.bubbles||a.bubbles,cancelable:!!a.cancelable,composed:void 0===a.composed||a.composed});return r.detail=o,this.dispatchEvent(r),r}computeColor(e,t){const n=this.config,i=n.color_thresholds,a=n.line_color,o=_objectSpread({color:a[t]||a[0]},i.find(t=>t.value<(+e||0)));return this.config.entities[t].color||o.color}computeName(e){return this.config.entities[e].name||this.entity[e].attributes.friendly_name}computeIcon(e){return this.config.icon||e.attributes.icon||Ne[e.attributes.device_class]||Ne.temperature}computeUom(e){return this.config.entities[e].unit||this.config.unit||this.entity[e].attributes.unit_of_measurement||""}computeState(e){var t=Math.round;const n=+e,i=this.config.decimals;if(i===void 0||o(i)||o(n))return t(100*n)/100;const a=10**i;return(t(n*a)/a).toFixed(i)}async updateData(){let e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this,t=e.config;const n=new Date,a=new Date;a.setHours(n.getHours()-t.hours_to_show);const o=this.entity.map((e,t)=>this.updateEntity(e,t,a,n));await Promise.all(o),this.updateQueue=[],this.bound=[t.lower_bound===void 0?s(...this.Graph.map(e=>e.min))||this.bound[0]:t.lower_bound,t.upper_bound===void 0?r(...this.Graph.map(e=>e.max))||this.bound[1]:t.upper_bound],t.show.graph&&(this.entity.forEach((e,n)=>{if(e&&0!==this.Graph[n].coords.length){var i=[this.bound[0],this.bound[1]];this.Graph[n].min=i[0],this.Graph[n].max=i[1],"bar"===t.show.graph?this.bar[n]=this.Graph[n].getBars(n,t.entities.length):(this.line[n]=this.Graph[n].getPath(),t.show.fill&&(this.fill[n]=this.Graph[n].getFill(this.line[n])),t.show.points&&(this.points[n]=this.Graph[n].getPoints()),0<t.color_thresholds.length&&!t.entities[n].color&&(this.gradient[n]=this.Graph[n].computeGradient(t.color_thresholds,t.entities[n].color||t.line_color[n]||t.line_color[0])))}}),this.line=[...this.line])}async updateEntity(e,t,n,i){if(!e||!this.updateQueue.includes(e.entity_id))return;let a=await this.fetchRecent(e.entity_id,n,i);a[0]&&(a=a[0].filter(e=>!o(parseFloat(e.state))),1>a.length||(e.entity_id===this.entity[0].entity_id&&(this.abs=[_objectSpread({type:"min"},Ee(a,"state")),_objectSpread({type:"max"},Ve(a,"state"))]),this.Graph[t].update(a)))}async fetchRecent(e,t,n){let i="history/period";return t&&(i+="/".concat(t.toISOString())),i+="?filter_entity_id=".concat(e),n&&(i+="&end_time=".concat(n.toISOString())),this._hass.callApi("GET",i)}getCardSize(){return 3}}customElements.define("mini-graph-card",ze)});
